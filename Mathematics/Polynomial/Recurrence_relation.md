# 常系数齐次线性递推

[模板](https://www.luogu.com.cn/problem/P4723)

给 $f$, 和 $a$ 的前 $k$ 项, 求 $a_n$. $a$ 满足

$$
a_n = \sum_{i = 1}^k f_ia_{n - i}
$$

一般遇到这种问题我们都会选择用矩阵快速幂进行转移, 但是这里 $k$ 的大小高达 $32000$, 所以无从下手.

先考虑 $n$ 较小的情况, 我们发现如果把 $a_i$ 到 $a_{i + j}$ 的总贡献 $F_j$ 看成一个多项式 $\displaystyle\sum_{j = 0}^{\infin} x^jF_j$. 发现满足这样的式子:

$$
F_i = \sum_{j = 1}^{i} F_{i - j}f_j
$$

可以使用分治 FFT 求出这个多项式. 复杂度 $O(n\log^2 n)$. 然后就可以 $O(n)$ 算出答案.

但是 $n$ 的范围是 $10^9$. 所以这个做法也寄了.
